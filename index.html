<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Exertion to Exhaustion</title>

    <link rel="stylesheet" href="./css/layout.css" />
    <link rel="stylesheet" href="./css/animation.css" />
    <link rel="stylesheet" href="./css/personal.css" />
    <link rel="stylesheet" href="./css/demographic.css" />

    <script src="./js/animation.js" type="module" defer></script>
    <script src="./js/personal.js" type="module" defer></script>
    <script src="./js/demographic.js" type="module" defer></script>
    <script src="./js/global.js" type="module" defer></script>

</head>
<body>

  <style>
    #reading-progress {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px;               /* thickness */
    background: rgba(0,0,0,0.1);
    z-index: 9999;
  }

  /* the actual progress fill */
  #reading-progress__bar {
    height: 100%;
    width: 0%;
    background: #1ebafa;        /* pick your accent color */
    transition: width 0.1s ease-out;
  }
  </style>
  <div id="reading-progress">
    <div id="reading-progress__bar"></div>
  </div>

<main>

    <br><br><br><br><br><br><br><br><br><br><br><br>

    <div class="header">
        <h1>What Happens In Your Body When You Run Until Exhausted?</h1>
        <br>
        <h3 id = "hook-explanation">Discover the physiological changes that occur during intense excercise. Our data come from over 900 Graded Exercise Tests.
            Participants ran on a treadmill that steadily increased in speed until they could no longer continue. A respiratory mask measured
            their oxygen consumption, carbon dioxide production, total respiratory volume, and other biometrics.
        </h3>
        <br>
        <div id="hook-terms">
            <h2>Terms to Know</h2>
            <ul>
                <li><strong>VO2:</strong> The amount of oxygen consumed by the body during exercise measured in mL/min.</li>
                <li><strong>VCO2:</strong> The amount of carbon dioxide produced by the body during exercise measured in mL/min.</li>
                <li><strong>VE:</strong> Minute Ventilation: The volume of air breathed measured in L/min.</li>
                <br>
                <li><strong>RER:</strong> Respiratory Exchange Ratio: a measure of the ratio of carbon dioxide produced to oxygen consumed.</li>
                <li><strong>VE/VCO2:</strong> Ventilatory Equivalent for CO2: a measure of the relationship between amount of air and carbon dioxide production.</li>
            </ul>
        </div>
    </div>

    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>


<!-- MAIN CONTAINER -->
<div class="container">
    <div class="visual">
      <div class="top-section">
        <div class="runner-row">
        
          <!-- LEFT COLUMN -->
          <div class="left-column">

        
            <!-- Image + Info -->
            <div style="display: flex; align-items: flex-start; gap: 20px;">
              <div class="runner-img-wrapper">
                <img id="runner-static" src="pictures/static_runner.png" class="runner-img">
                <img id="runner-animated" src="pictures/runner.gif" class="runner-img" style="display: none;">
              </div>
  
              <div class="runner-info info-box">
                <h2>Runner Info</h2>
                <p><strong>ID:</strong> <span id="runner-id">--</span></p>
                <p><strong>Age:</strong> <span id="runner-age">--</span></p>
                <p><strong>Sex:</strong> <span id="runner-sex">--</span></p>
                <p><strong>Weight:</strong> <span id="runner-weight">--</span> kg</p>
                <p><strong>Height:</strong> <span id="runner-height">--</span> cm</p>
              </div>
            </div>
  
            <!-- Time Elapsed Bar -->
            <div class="bar-section">
              <div class="timer-label"><strong>Time Elapsed:</strong> <span id="time-label">00:00</span></div>
              <svg width="600" height="40">
                <rect class="bar-bg" x="0" y="5" width="600" height="30" rx="5" ry="5"></rect>
                <rect class="bar-fill" x="0" y="5" width="0" height="30" rx="5" ry="5"></rect>
              </svg>
            </div>
  
            <!-- Controls -->
            <div class="controls">
              <button id="play-btn">▶ Play</button>
              <button id="pause-btn">⏸ Pause</button>
              <button id="reset-btn">⟳ Reset</button>
            </div>
  
            <!-- Threshold Popup -->
            <div id="threshold-side-message" class="info-box" style="display: none; width: 500px;">
              <div id="threshold-text"></div>
              <button id="continue-btn">Continue</button>
            </div>
  
            <!-- Plot Explanation Box -->
            <div class="threshold-intro info-box" style="width: 950px;">
                <h2>Why Are We Showing These Two Plots?</h2>
                <p>These graphs show how your breathing and gas exchange change as you run harder.</p>
                <p>As exercise intensity increases, your body shifts how it produces and clears energy.</p>
                <p>A spike in <strong>VCO₂ / VO₂</strong> means your body is starting to rely more on anaerobic metabolism. This is known as the first ventilatory threshold (VT1).</p>
                <p>A spike in <strong>VE / VCO₂</strong> means your breathing rate sharply increases to remove excess CO₂. This marks the second ventilatory threshold (VT2), when acid builds up too fast to buffer.</p>
                <p>During the simulation, we’ll pause at each threshold to explain what’s happening inside your body.</p>
              </div>
              
          </div>
  
          <!-- RIGHT COLUMN: GRAPHS -->
          <div class="graph-column">
            <div id="threshold-graph-1" class="threshold-graph-box">
              <h3>FIRST THRESHOLD</h3>
              <!-- Graph content -->
            </div>
            <div id="threshold-graph-2" class="threshold-graph-box">
              <h3>SECOND THRESHOLD</h3>
              <!-- Graph content -->
            </div>
          </div>
  
        </div>
      </div>
    </div>
  </div>
  
    
      
      


    <br><br><br><br><br><br><br><br><br><br><br><br>

    <div id="identifying-container">
        <h1 id="identifying-title">How to Identify the Thresholds</h1>
        <div id="identifying-instructions-container">
            <div id="instructions-vt1-plot"></div>
            <div id="instructions-vt2-plot"></div>
        </div>
        <div id="identifying-instructions-text">
            <div id="identifying-instructions-vt1" class="shadow-box">
                <h2>Identifying the Aerobic Threshold</h2>
                <ol>
                    <li>Use the shape of the Respiratory Exchange Ratio (RER) (VCO<sub>2</sub> / O<sub>2</sub>) curve.</li>
                    <li>Before the threshold, CO<sub>2</sub> production matches O<sub>2</sub> consumption resulting in a constant ratio.</li>
                    <li>At the threshold, excess CO<sub>2</sub> is produced in the blood from bicarbonate buffering lactic acid, increasing the ratio.</li>
                </ol>
            </div>
            <div id="identifying-instructions-vt2" class="shadow-box">
                <h2>Identifying the Anaerobic Threshold</h2>
                <ol>
                    <li>Use the shape of the Ventilatory Equivalent for CO<sub>2</sub> (VE/VCO<sub>2</sub>) curve.</li>
                    <li>Before the threshold, VE/VCO<sub>2</sub> remains constant or decreases.</li>
                    <li>After the threshold, the body attempts to raise it's blood pH by increasing ventilation, causing VE/VCO<sub>2</sub> to rise.</li>
                </ol>
            </div>
        </div>
        <div id="identifying-threshold-container">
            <div id="identifying-threshold-1"></div>
            <div id="identifying-threshold-2"></div>
            <div id="id-vt1-tooltip" class="threshold-tooltip" style="display: none;">Select The Aerobic Threshold</div>
            <div id="id-vt2-tooltip" class="threshold-tooltip" style="display: none;">Select The Anaerobic Threshold</div>
        </div>
    </div>

    <div id="personal-vis">
        <h1 id="personal-vis-title"> Explore Runners Similar to You</h1>
        <div id="input-row">
            <select id="units-input" class="user-input" name="units">
                <option value="metric">Metric</option>
                <option value="imperial">Imperial</option>
            </select>
            <select id="sex-input" class="user-input" name="sex">
                <option value="" selected>Choose sex...</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select>
            <input type="text" placeholder="Enter Age ..." id="age-input" class="user-input" />
            <input type="text" placeholder="Enter Height (cm) ..." id="height-input" class="user-input" />
            <input type="text" placeholder="Enter Weight (kg) ..." id="weight-input" class="user-input" />  
        </div>
        <div id="personal-vis-instructions">
            <h2>Instructions</h2>
            <ol>
                <li>Select a runner by clicking on their progress bar.</li>
                <li>Mark their ventilatory thresholds by clicking on the plots below.</li>
                <li>Try a different runners and compare the results.</li>
            </ol>
        </div>
        <div id="personal-vis-content">
            <div id="runners-table"></div>
            <div id="runners-bar-plot"></div>
            <div id="runner-tooltip" class="threshold-tooltip" style="display: none;">Select Runner</div>
        </div>
        <div id="runner-threshold-container">
            <div id="runner-threshold-1"></div>
            <div id="runner-threshold-2"></div>
            <div id="vt1-tooltip" class="threshold-tooltip" style="display: none;">Select Aerobic Threshold</div>
            <div id="vt2-tooltip" class="threshold-tooltip" style="display: none;">Select Anaerobic Threshold</div>
        </div>
        <div id="threshold-tips">
            <div id="vt1-tips" class="draw-attention">
                <h3 class = "tips-heading"><span style="color: limegreen;">Aerobic</span> Threshold Tips</h3>
                <ul>
                    <li>Start your search in the first half of the test.</li>
                    <li>Look for the point where RER starts to increase.</li>
                    <li>Often occurs 0.8 - 0.9 RER.</li>
                    
                </ul>
            </div>
            <div id ="vt2-tips" class="draw-attention">
                <h3 class = "tips-heading"><span style="color: red;">Anaerobic</span> Threshold Tips</h3>
                <ul>
                    <li>Start your search in the last third of the test.</li>
                    <li>Look for the point where VE/VCO2 starts to increase after decreasing or remaining constant</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- <section id="demographic-section"> -->
      <!-- <h2 id="demographic-title"> -->
        <!-- Physiological Metrics by Demographic &amp; Performance -->
      <!-- </h2> -->
      <!-- placeholder for D3 to hook into -->
      <!-- <div id="demographic-viz-container"></div> -->
    <!-- </section> -->

    <!-- Replace the commented section with: -->


    <!-- put this in your main CSS (e.g. layout.css) -->
<style>
  /* ————— Transition Section Styles ————— */
  .transition-section {
    margin: 120px 0;                     /* lots of space above & below */
    padding: 160px 130px;                  /* roomy inset padding */
    background-color: #111;              /* very dark gray */
    border-left: 6px solid #1ebafa;      /* accent stripe (same as your progress bar) */
    border-right: 6px solid #1ebafa;      /* accent stripe (same as your progress bar) */

    border-radius: 6px;                  /* slightly rounded corners */
    box-shadow: 0 4px 12px rgba(0,0,0,0.6);
    color: #f5f5f5;                      /* light text */
    text-align: center;
  }

  .transition-section p {
    margin: 0 auto;
    max-width: 700px;                    /* keep lines comfortably narrow */
    font-size: 1.3rem;
    line-height: 1.6;
  }
</style>

<!-- then drop this where you want the transition -->
<section class="transition-section">
  <p>
    In the next section, we’ll explore how different demographic groups differ, or sometimes overlap, in the average time they take to reach their aerobic and anaerobic thresholds. We’ll also walk through how their respiration rates and O<sub>2</sub> intake vary across these groups.
  </p>
</section>







    <!-- Add these rules to your CSS (e.g. demographic.css) to get consistent spacing -->
  <style>
  /* Container: left narrative, right viz */
  .scroll-container {
    display: grid;
    /* narrow text column so the viz gets more room */
    grid-template-columns: 280px 1fr;
    gap: 2rem;
  }

  /* Left column should scroll independently */
  #story-column {
    display: flex;
    flex-direction: column;
    /* add this line: */
    gap: 2rem;              /* 2rem between each .story-section */
    max-height: 80vh;
    overflow-y: auto;
    padding-right: 1rem;
    border-right: 1px solid #ddd;
  }

  /* Each “step” in your story */
  .story-section {
    margin-bottom: 2rem;
  }

  .story-section .subsection {
    margin-top: 1rem;
    padding-left: 1rem;
    border-left: 3px solid var(--color-accent);
  }

  /* Right column: make the viz stick while you scroll text */
  #demographic-viz-container {
    position: sticky;
    top: 1rem;
    align-self: start;
    width: 100%;
    min-height: 80vh;
  }
    .story-section {
      margin-bottom: 3rem;
    }
    .subsection {
      margin: 2rem 0;
      padding-left: 1rem;
      border-left: 3px solid var(--color-accent);
    }
  </style>

  <section id="demographic-section">

    
    <h2 id="demographic-title">
      Physiological Metrics by Demographic &amp; Performance
    </h2>

    <div class="scroll-container">
      <!-- LEFT: narrative steps -->
      <div id="story-column">

        <!-- AGE GROUP -->
        <div class="story-section">

          <h3 id="story-heading">Highlights from Selected Demographic Groups</h3>

          <h3>Age Group</h3>

          <div class="subsection"
             data-demo="age_group"
             data-metric="time_th1">
          <h4>Threshold</h4>
          <p>
            From the graph, there is no clear trend that one age group
            takes more time to reach the first ventilatory threshold than
            the others.
          </p>
        </div>

          <div class="subsection"
              data-demo="age_group"
              data-metric="threshold_gap">
            <h4>Threshold Gap</h4>
            <p>
              Gap is calculated as time of threshold 2 − time of threshold 1.
              The longer the gap, the healthier the running (between these two
              thresholds the body is burning fats). People aged 19–30 tend to
              have the highest gap across performance levels, while 0–18 and
              31+ fall behind.
            </p>
          </div>

          <div class="subsection"
              data-demo="age_group"
              data-metric="HR">
            <h4>Heart Rate</h4>
            <p>
              The older the participants get, the lower their average heart rate.
              Across all performance bins, 0–18 year-olds have the highest HR,
              19–30 are in the middle, and 31+ are the lowest.
            </p>
          </div>

          <div class="subsection"
              data-demo="age_group"
              data-metric="O2_vol">
            <h4>O₂ Volume</h4>
            <p>
              Older groups consistently consume more oxygen. 0–18 year-olds
              always stay below ~61.5 mL/min, whereas 19+ groups reach ~70 mL/min
              in most performance bins.
            </p>
          </div>
        </div>

        <!-- BMI GROUP -->
        <div class="story-section">
          <h3>BMI Group</h3>

          <div class="subsection"
              data-demo="bmi_group"
              data-metric="time_th1">
            <h4>Threshold</h4>
            <p>
              From the graph, underweight runners tend to take longer to hit
              the first threshold at higher performance levels, while lower
              performers reach it at roughly the same time.
            </p>
          </div>

          <div class="subsection"
              data-demo="bmi_group"
              data-metric="RR">
            <h4>Respiration Rate</h4>
            <p>
              Underweight participants always show the highest respiration rate
              (≥ 43 breaths/min). Normal and overweight groups are similar,
              but never exceed ~40 breaths/min.
            </p>
          </div>

          <div class="subsection"
              data-demo="bmi_group"
              data-metric="CO2_vol">
            <h4>CO₂ Volume</h4>
            <p>
              Heavier groups produce more CO₂. Overweight individuals top the
              chart, followed by normal weight, then underweight.
            </p>
          </div>
        </div>

        <!-- SEX -->
        <div class="story-section">
          <h3>Sex</h3>

          <div class="subsection"
              data-demo="sex"
              data-metric="time_th2">
            <h4>Threshold</h4>
            <p>
              VT2 occurs at roughly the same time for both sexes, indicating
              similar endurance capacity before anaerobic metabolism kicks in.
            </p>
          </div>

          <div class="subsection"
              data-demo="sex"
              data-metric="O2_vol">
            <h4>O₂ Volume</h4>
            <p>
              Males consistently take in more oxygen (~72–73 mL/min) than
              females (< 60 mL/min) across all performance bins.
            </p>
          </div> 
        </div>

        <div class="story-section">
          <h3>Conclusion</h3>
          <div class="subsection">
            <p>
              Throughout our journey you’ve seen how <strong>age</strong>, <strong>BMI</strong>, and <strong>sex</strong>
              each shape your physiological response to graded exercise. Younger runners spike their heart rate highest, 
              19–30-year-olds hold the widest healthy “gap” between thresholds, underweight folks breathe fastest, 
              and heavier groups produce more CO₂. While males take in more oxygen on average, both sexes cross their 
              second threshold at almost the same point.
            </p>
            <p>
              These insights remind us that there’s no one-size-fits-all in training, knowing your own demographics 
              and performance bracket can help you tailor workouts for safer, more effective progress.
            </p>
          </div>
        </div>

      </div>

      <!-- RIGHT: the sticky D3 hook -->
      <div id="demographic-viz-container"></div>
    </div>
  </section>



    <br><br><br><br><br><br><br><br><br><br><br><br>

</main>
</body>
</html>
